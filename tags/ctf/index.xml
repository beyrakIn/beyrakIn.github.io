<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ctf on Beyrak's Blog</title><link>https://beyrakin.github.io/tags/ctf/</link><description>Recent content in ctf on Beyrak's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Beyrak A.</copyright><lastBuildDate>Tue, 26 Jul 2022 23:28:37 +0400</lastBuildDate><atom:link href="https://beyrakin.github.io/tags/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>Jobfier-CTF walkthrough | TryHackMe</title><link>https://beyrakin.github.io/posts/2022/jobfierctf/</link><pubDate>Tue, 26 Jul 2022 23:28:37 +0400</pubDate><guid>https://beyrakin.github.io/posts/2022/jobfierctf/</guid><description>Jobfier-CTF walkthrough My friend sent me This LinkedIn post. Which is Jobfier&amp;rsquo;s team had prepared this task to find cyber-security professionals. My time had come. Let&amp;rsquo;s hack the box.
Let&amp;rsquo;s start the machine and got its ip address. Our machine ip address is 10.10.50.121
Let do basic nmap scan to find open ports. As we can see port 80http and 6666ssh is open I open the page on the browser and catch request and response with BurpSuite.</description><content>&lt;h1 id="jobfier-ctf-walkthrough">Jobfier-CTF walkthrough&lt;/h1>
&lt;p>My friend sent me &lt;a href="https://www.linkedin.com/posts/tfuad_m%C9%99n%C9%99m-m%C9%99n%C9%99m-dey%C9%99n-kibert%C9%99hl%C3%BCk%C9%99sizlik-%C9%99jdahalar%C4%B1-activity-6953319528546099200-1gCw?utm_source=linkedin_share&amp;amp;utm_medium=member_desktop_web">&lt;em>&lt;strong>This&lt;/strong>&lt;/em>&lt;/a> LinkedIn post.
Which is &lt;strong>Jobfier&amp;rsquo;s&lt;/strong> team had prepared this &lt;a href="https://tryhackme.com/room/jobfierctf">&lt;strong>task&lt;/strong>&lt;/a> to find cyber-security professionals.
My time had come. Let&amp;rsquo;s hack the box.&lt;/p>
&lt;p>Let&amp;rsquo;s start the machine and got its ip address.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-1.png" alt="">&lt;/p>
&lt;p>Our machine ip address is &lt;code>10.10.50.121&lt;/code>&lt;/p>
&lt;p>Let do basic nmap scan to find open ports.
As we can see port &lt;code>80&lt;/code>&lt;em>http&lt;/em> and &lt;code>6666&lt;/code>&lt;em>ssh&lt;/em> is open
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-4.png" alt="">&lt;/p>
&lt;p>I open the page on the browser and catch request and response with BurpSuite.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-2.png" alt="">&lt;/p>
&lt;p>We can see &lt;code>raphaelsportfolio.com&lt;/code> as HTML comment.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-3.png" alt="">&lt;/p>
&lt;p>Let&amp;rsquo;s add this domain to &lt;code>/etc/hosts&lt;/code> file
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-5.png" alt="">&lt;/p>
&lt;p>Then open this link on your browser. You can scan this domain with &lt;code>dirb&lt;/code> or &lt;code>gobuster&lt;/code> to find available paths.
I found password list on &lt;code>/robots.txt&lt;/code>.&lt;/p>
&lt;p>Save these passwords probably we will need this to attack the account.&lt;br>
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-8.png" alt="">&lt;/p>
&lt;p>I also found certificate image on website. There is &lt;code>mrrafael&lt;/code> username on it.
We have wordlist and username. Let&amp;rsquo;s find login page and try to find correct account password.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-6.png" alt="">&lt;/p>
&lt;p>There was login button on website. No need additional effort to find this.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-7.png" alt="">&lt;/p>
&lt;p>I try &lt;code>mrrafael&lt;/code> as a username and &lt;code>password&lt;/code> as a password.
Then I did catch the request with BurpSuite. As you can see there are username &lt;strong>(2)&lt;/strong> and password &lt;strong>(1)&lt;/strong> fields.
I sent this request to &lt;em>intruder&lt;/em>.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-9.png" alt="">&lt;/p>
&lt;p>I know username, I need just to find password. That&amp;rsquo;s why I add only &lt;code>password&lt;/code> field to brute-force.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-11.png" alt="">&lt;/p>
&lt;p>Every wrong passwords return &lt;code>302&lt;/code>&lt;strong>(1)&lt;/strong> http status code &lt;em>(redirection)&lt;/em>,
probably correct password also returns &lt;code>302&lt;/code>. This response also returns path &lt;strong>(2)&lt;/strong> with &lt;code>Location&lt;/code> header.
Wrong passwords &lt;code>Location&lt;/code> value is &lt;code>/accounts/login/&lt;/code>. The correct password will return different Location value.
that&amp;rsquo;s why we should &lt;strong>follow redirection&lt;/strong> to analyze password is correct or not.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-10.png" alt="">&lt;/p>
&lt;p>Load passwords which is we found it on &lt;code>/robots.txt&lt;/code>.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-12.png" alt="">&lt;/p>
&lt;p>Don&amp;rsquo;t forget to enable intruder&amp;rsquo;s &lt;strong>Follow redirection&lt;/strong> &lt;em>(2)&lt;/em>. You can find it under the &lt;strong>Options&lt;/strong> &lt;em>(1)&lt;/em>.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-13.png" alt="">&lt;/p>
&lt;p>Start tha attack and analyze the results. As you can see payload &lt;code>999999&lt;/code> differently return two times.
Let&amp;rsquo;s check this.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-30.png" alt="">&lt;/p>
&lt;p>Look at this. This response redirects us to &lt;code>/account/404&lt;/code>.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-31.png" alt="">&lt;/p>
&lt;p>Look at page, there is nothing.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-14.png" alt="">&lt;/p>
&lt;p>If we open source code of this page we can see &lt;code>img&lt;/code> tag, but we can&amp;rsquo;t see this image on page.
because css &lt;code>display&lt;/code> attribute&amp;rsquo;s value is &lt;code>none&lt;/code>. That&amp;rsquo;s why we can&amp;rsquo;t see thi on the page.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-15.png" alt="">&lt;/p>
&lt;p>Open the image. There are some hints for us.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-16.png" alt="">&lt;/p>
&lt;p>Download image.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-17.png" alt="">&lt;/p>
&lt;p>Use &lt;code>steghide&lt;/code> tool to extract hidden data.
Don&amp;rsquo;t forget to tell magic words.&lt;/p>
&lt;ul>
&lt;li>please&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/flag-1.png" alt="">&lt;/p>
&lt;p>We found url in flag1. Add this domain to &lt;code>/etc/hosts&lt;/code> file.
Then visit the website. keyword is &lt;code>ssh_key&lt;/code>.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-18.png" alt="">&lt;/p>
&lt;p>&lt;strong>this link&lt;/strong> move us to another page.
This page get value from path, runs something and returns a result.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-19.png" alt="">&lt;/p>
&lt;p>Manually I enter &lt;code>' '1'='1&lt;/code> sql injection payload after the previous code, and it returns all values.
There is sql injection vulnerability on this page.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-20.png" alt="">&lt;/p>
&lt;p>Let&amp;rsquo;s exploit this with &lt;code>sqlmap&lt;/code>. If you don&amp;rsquo;t know &lt;code>sqlmap&lt;/code> options, you can google it.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-21.png" alt="">&lt;/p>
&lt;p>We found &lt;code>users&lt;/code> table on this database. Look at this there is &lt;code>ssk_key&lt;/code> column.
That&amp;rsquo;s password we need this to connect server via &lt;code>ssh&lt;/code>.&lt;/p>
&lt;p>&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-22.png" alt="">&lt;/p>
&lt;p>Let&amp;rsquo;s connect server.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-23.png" alt="">&lt;/p>
&lt;p>This user&amp;rsquo;s default session is &lt;code>python&lt;/code>. we need to change it to &lt;code>shell&lt;/code>.
use below commands to do it.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-24.png" alt="">&lt;/p>
&lt;p>There is &lt;code>flag2.txt&lt;/code> here, but we can&amp;rsquo;t read because we don&amp;rsquo;t have enough privilege to read this file and this file owner is another user.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-25.png" alt="">&lt;/p>
&lt;p>We come to my favorite part: &lt;strong>Linux privilege escalation&lt;/strong>
For find possible escalation techniques you can use different scripts.
In this situation I used &lt;code>linenum.sh&lt;/code>.
In order to transfer this file to target machine I used python script.&lt;/p>
&lt;p>&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-26.png" alt="">&lt;/p>
&lt;p>There was &lt;code>wget&lt;/code> on target machine, and I downloaded it easily.
Before the download you should change your directory to &lt;code>tmp&lt;/code>.
Because at there you can download and execute script.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-27.png" alt="">&lt;/p>
&lt;p>I run it and found some privilege escalation vectors. One of them is that.
&lt;code>find&lt;/code> command&amp;rsquo;s &lt;code>SUID&lt;/code> bit is active. We can run it with root privileges.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-28.png" alt="">&lt;/p>
&lt;p>Use this command to gain root privileges.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-29.png" alt="">&lt;/p>
&lt;p>Now we got the root privileges. We can read all files.
&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/flag-2-3.png" alt="">&lt;/p>
&lt;p>That&amp;rsquo;s all.&lt;/p>
&lt;p>&lt;img src="https://beyrakin.github.io/posts/2022/images/jobfier/jobfier-cover.png" alt="jobfier-cover">&lt;/p>
&lt;ul>
&lt;li>Mission completed✅&lt;/li>
&lt;/ul></content></item></channel></rss>